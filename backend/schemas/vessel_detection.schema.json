{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "$id": "https://sentinel-sea.org/schemas/vessel-detection.json",
    "title": "Maritime Vessel Detection Record",
    "description": "Schema for detected maritime vessels from Sentinel-1 SAR imagery with AIS correlation and threat assessment",
    "type": "object",
    "required": [
        "detection_id",
        "timestamp",
        "latitude",
        "longitude",
        "sar_features",
        "estimated_vessel_size_category",
        "ais_status",
        "threat_score",
        "analyst_review_status",
        "detection_source",
        "inside_protected_area"
    ],
    "properties": {
        "detection_id": {
            "type": "string",
            "description": "Unique identifier for the detection event",
            "pattern": "^VSL-[0-9]{8}-[A-Z][0-9]{3}$",
            "example": "VSL-20240129-A001"
        },
        "timestamp": {
            "type": "string",
            "format": "date-time",
            "description": "ISO 8601 timestamp of detection event",
            "example": "2024-01-29T14:30:00Z"
        },
        "latitude": {
            "type": "number",
            "description": "Geographic latitude in decimal degrees",
            "minimum": -90,
            "maximum": 90,
            "example": 12.4567
        },
        "longitude": {
            "type": "number",
            "description": "Geographic longitude in decimal degrees",
            "minimum": -180,
            "maximum": 180,
            "example": 78.9012
        },
        "sar_features": {
            "type": "object",
            "description": "Features extracted from Sentinel-1 SAR imagery",
            "required": [
                "area",
                "mean_intensity",
                "elongation_ratio"
            ],
            "properties": {
                "area": {
                    "type": "number",
                    "description": "Detected target area in square meters",
                    "minimum": 0,
                    "example": 320.5
                },
                "mean_intensity": {
                    "type": "number",
                    "description": "Mean backscatter intensity in decibels (dB)",
                    "example": -12.5
                },
                "elongation_ratio": {
                    "type": "number",
                    "description": "Length-to-width ratio (shape proxy)",
                    "minimum": 1,
                    "example": 3.2
                },
                "max_intensity": {
                    "type": "number",
                    "description": "Peak backscatter intensity in decibels (dB)",
                    "example": -8.3
                },
                "std_intensity": {
                    "type": "number",
                    "description": "Standard deviation of backscatter intensity",
                    "minimum": 0,
                    "example": 2.1
                },
                "perimeter": {
                    "type": "number",
                    "description": "Target perimeter in meters",
                    "minimum": 0,
                    "example": 85.4
                },
                "confidence_score": {
                    "type": "number",
                    "description": "CFAR detection confidence score",
                    "minimum": 0,
                    "maximum": 1,
                    "example": 0.89
                }
            },
            "additionalProperties": false
        },
        "estimated_vessel_size_category": {
            "type": "string",
            "description": "Vessel size classification from Random Forest model",
            "enum": [
                "small",
                "medium",
                "large",
                "very_large"
            ],
            "example": "large"
        },
        "estimated_length_meters": {
            "type": "number",
            "description": "Estimated vessel length in meters (optional)",
            "minimum": 0,
            "example": 45
        },
        "ais_status": {
            "type": "boolean",
            "description": "AIS broadcast detected within spatial tolerance (true = AIS ON, false = AIS OFF)",
            "example": false
        },
        "ais_match_details": {
            "type": "object",
            "description": "Details of AIS match if ais_status is true",
            "properties": {
                "mmsi": {
                    "type": "string",
                    "description": "Maritime Mobile Service Identity number",
                    "pattern": "^[0-9]{9}$",
                    "example": "123456789"
                },
                "vessel_name": {
                    "type": "string",
                    "description": "Vessel name from AIS broadcast",
                    "example": "FISHING VESSEL 123"
                },
                "vessel_type": {
                    "type": "string",
                    "description": "Vessel type from AIS classification",
                    "example": "Fishing"
                },
                "distance_meters": {
                    "type": "number",
                    "description": "Distance between SAR detection and AIS position in meters",
                    "minimum": 0,
                    "example": 125.3
                },
                "time_delta_seconds": {
                    "type": "number",
                    "description": "Time difference between SAR and AIS timestamp in seconds",
                    "example": 180
                }
            },
            "additionalProperties": false
        },
        "threat_score": {
            "type": "integer",
            "description": "Computed threat score (0-100) based on AIS status, size, and location",
            "minimum": 0,
            "maximum": 100,
            "example": 87
        },
        "threat_factors": {
            "type": "array",
            "description": "Array of contributing threat factors",
            "items": {
                "type": "string",
                "enum": [
                    "no_ais_broadcast",
                    "inside_protected_area",
                    "large_vessel_profile",
                    "high_intensity_signature",
                    "night_time_operation",
                    "proximity_to_boundary"
                ]
            },
            "example": [
                "no_ais_broadcast",
                "inside_protected_area",
                "large_vessel_profile"
            ]
        },
        "analyst_review_status": {
            "type": "string",
            "description": "Current status of analyst review",
            "enum": [
                "pending",
                "confirmed",
                "dismissed"
            ],
            "example": "pending"
        },
        "review_timestamp": {
            "type": [
                "string",
                "null"
            ],
            "format": "date-time",
            "description": "ISO 8601 timestamp of analyst review (null if pending)",
            "example": "2024-01-29T15:45:00Z"
        },
        "analyst_id": {
            "type": [
                "string",
                "null"
            ],
            "description": "Identifier of analyst who reviewed the detection",
            "example": "analyst_001"
        },
        "analyst_notes": {
            "type": [
                "string",
                "null"
            ],
            "description": "Freeform notes from analyst review",
            "maxLength": 1000,
            "example": "Confirmed illegal fishing vessel operating without transponder"
        },
        "detection_source": {
            "type": "string",
            "description": "Source of detection data",
            "const": "Sentinel-1 SAR",
            "example": "Sentinel-1 SAR"
        },
        "sentinel_metadata": {
            "type": "object",
            "description": "Metadata about the Sentinel-1 acquisition",
            "properties": {
                "product_id": {
                    "type": "string",
                    "description": "Sentinel-1 product identifier",
                    "example": "S1A_IW_GRDH_1SDV_20240129T143000_20240129T143025_051234_062ABC_1234"
                },
                "orbit_number": {
                    "type": "integer",
                    "description": "Sentinel-1 orbit number",
                    "example": 51234
                },
                "polarization": {
                    "type": "string",
                    "description": "SAR polarization mode",
                    "enum": [
                        "VV",
                        "VH",
                        "HH",
                        "HV"
                    ],
                    "example": "VV"
                },
                "incidence_angle": {
                    "type": "number",
                    "description": "Radar incidence angle in degrees",
                    "minimum": 0,
                    "maximum": 90,
                    "example": 34.5
                }
            },
            "additionalProperties": false
        },
        "inside_protected_area": {
            "type": "boolean",
            "description": "Whether detection is inside a Marine Protected Area boundary",
            "example": true
        },
        "protected_area_name": {
            "type": [
                "string",
                "null"
            ],
            "description": "Name of the Marine Protected Area if inside_protected_area is true",
            "example": "Gulf of Mannar Marine National Park"
        },
        "distance_to_boundary_meters": {
            "type": [
                "number",
                "null"
            ],
            "description": "Distance to nearest MPA boundary in meters (negative if inside, positive if outside)",
            "example": -1250.5
        },
        "created_at": {
            "type": "string",
            "format": "date-time",
            "description": "Database record creation timestamp",
            "example": "2024-01-29T14:30:15Z"
        },
        "updated_at": {
            "type": "string",
            "format": "date-time",
            "description": "Database record last update timestamp",
            "example": "2024-01-29T15:45:30Z"
        }
    },
    "additionalProperties": false,
    "examples": [
        {
            "detection_id": "VSL-20240129-A001",
            "timestamp": "2024-01-29T14:30:00Z",
            "latitude": 12.4567,
            "longitude": 78.9012,
            "sar_features": {
                "area": 320.5,
                "mean_intensity": -12.5,
                "elongation_ratio": 3.2,
                "max_intensity": -8.3,
                "std_intensity": 2.1,
                "perimeter": 85.4,
                "confidence_score": 0.89
            },
            "estimated_vessel_size_category": "large",
            "estimated_length_meters": 45,
            "ais_status": false,
            "ais_match_details": null,
            "threat_score": 87,
            "threat_factors": [
                "no_ais_broadcast",
                "inside_protected_area",
                "large_vessel_profile"
            ],
            "analyst_review_status": "pending",
            "review_timestamp": null,
            "analyst_id": null,
            "analyst_notes": null,
            "detection_source": "Sentinel-1 SAR",
            "sentinel_metadata": {
                "product_id": "S1A_IW_GRDH_1SDV_20240129T143000_20240129T143025_051234_062ABC_1234",
                "orbit_number": 51234,
                "polarization": "VV",
                "incidence_angle": 34.5
            },
            "inside_protected_area": true,
            "protected_area_name": "Gulf of Mannar Marine National Park",
            "distance_to_boundary_meters": -1250.5,
            "created_at": "2024-01-29T14:30:15Z",
            "updated_at": "2024-01-29T14:30:15Z"
        },
        {
            "detection_id": "VSL-20240129-A002",
            "timestamp": "2024-01-29T14:25:00Z",
            "latitude": 12.4890,
            "longitude": 78.8765,
            "sar_features": {
                "area": 180.2,
                "mean_intensity": -14.2,
                "elongation_ratio": 2.8,
                "confidence_score": 0.92
            },
            "estimated_vessel_size_category": "medium",
            "estimated_length_meters": 28,
            "ais_status": true,
            "ais_match_details": {
                "mmsi": "123456789",
                "vessel_name": "COASTAL TRADER",
                "vessel_type": "Cargo",
                "distance_meters": 125.3,
                "time_delta_seconds": 180
            },
            "threat_score": 23,
            "threat_factors": [],
            "analyst_review_status": "confirmed",
            "review_timestamp": "2024-01-29T15:30:00Z",
            "analyst_id": "analyst_001",
            "analyst_notes": "Legitimate cargo vessel with valid AIS",
            "detection_source": "Sentinel-1 SAR",
            "inside_protected_area": false,
            "protected_area_name": null,
            "distance_to_boundary_meters": 5420.8,
            "created_at": "2024-01-29T14:25:15Z",
            "updated_at": "2024-01-29T15:30:05Z"
        }
    ]
}